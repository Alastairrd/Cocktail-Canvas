<!DOCTYPE html>
<html>
	<head>
		<title>Create Menu: <%=appData.appName%></title>
		<link rel="stylesheet" type="text/css" href="/main.css" />
	</head>
	<body>
		<div>
			<!--top banner for edit menu-->
			<div id="edit-menu-banner">
				<h1>Edit a menu: <%=appData.appName%></h1>
				<p>Search for cocktail recipes to add to your menu, or add your own!</p>
			</div>

			<!--section for listing current menu and adding a custom cocktail-->
			<div id="edit-container">
				<div id="add-list-container">
					<div id="add-div">
						<!--custom cocktail add form-->
						<form method="POST" action="add-cocktail-to-menu">
							<!--name-method-price section-->
							<p class="cocktail-subheading">Custom Cocktail Details</p>
							<p>
								<input type="hidden" name="menu_id" value="<%=menu_id%>">
								Cocktail name:
								<input
									id="add_cocktail_name"
									type="text"
									name="add_cocktail_name"
									value=""
									maxlength="50"
								/>
							</p>
							<p>
								Cocktail method:
								<input
									id="add_cocktail_method"
									type="text"
									name="add_cocktail_method"
									value=""
									maxlength="256"
								/>
							</p>
							<p>Glass: <input
								id="add_cocktail_glass"
								type="text"
								name="add_cocktail_glass"
								value=""
								maxlength="32"
							/></p>
							<p>Price: Â£<input
								id="add_cocktail_price"
								type="number"
								name="add_cocktail_price"
								value="0.00"
								max="99999.99"
								min="0"
								step="0.01"
							/></p>
							<!--ingredient and measures section-->
							<div id="ingredients-container">
								<p class="cocktail-subheading">
										Ingredients and Measurements
								</p>
								<!--ingredient/measurement pair -->
								<div class="ingredient-pair">
										<input
												type="text"
												name="ingredients[]"
												placeholder="Ingredient"
												maxlength="50"
										/>
										<input
												type="text"
												name="measurements[]"
												placeholder="Measurement"
												maxlength="50"
										/>
										<button type="button" class="remove-btn">Remove</button>
								</div>
						</div>
						<button type="button" id="add-ingredient-btn">Add Ingredient</button>


						<input type="submit" value="Create" />
						</form>
					</div>
					<div id="current-list-div">
						<ul>
							<% for(i=0; i<menuList.length; i++) { %>
								<li>
									<div class="cocktail-item-div">
										<p class="cocktail-item-name"><%=menuList[i].drink_name%></p>
										<p class="cocktail-item-method"><%=menuList[i].drink_method%></p>
										<p class="cocktail-item-glass"><%=menuList[i].drink_glass%></p>
										<p class="cocktail-item-price"><%=menuList[i].drink_price%></p>
										<ul class="cocktail-ingr-list">
											<% for(i=0; i<menuList[i].ingredients.length; i++) { %>
												<li class="ingredient-list-item">
													<p><%=menuList[i].ingredients[i]%> : <%=menuList[i].measures[i]%></p>
												</li>
											<% } %>
										</ul>
									</div>
								</li>
							<% } %>
						</ul>
					</div>
				</div>
				<div id="search-list-container">
					<div id="search-div">
				
					</div>
					<div id="result-list-div">
				
					</div>
				</div>
			</div>
		</div>
	</body>
	<script>
    document.addEventListener("DOMContentLoaded", () => {
        const ingredientsContainer = document.getElementById("ingredients-container");
        const addIngredientBtn = document.getElementById("add-ingredient-btn");

        // Add new ingredient/measurement pair
        addIngredientBtn.addEventListener("click", () => {
            const ingredientPair = document.createElement("div");
            ingredientPair.classList.add("ingredient-pair");

            // Ingredient input
            const ingredientInput = document.createElement("input");
            ingredientInput.type = "text";
            ingredientInput.name = "ingredients[]";
            ingredientInput.placeholder = "Ingredient";
            ingredientInput.maxLength = 50;

            // Measurement input
            const measurementInput = document.createElement("input");
            measurementInput.type = "text";
            measurementInput.name = "measurements[]";
            measurementInput.placeholder = "Measurement";
            measurementInput.maxLength = 50;

            // Remove button
            const removeBtn = document.createElement("button");
            removeBtn.type = "button";
            removeBtn.classList.add("remove-btn");
            removeBtn.textContent = "Remove";

            // Remove ingredient/measurement pair on click
            removeBtn.addEventListener("click", () => {
                ingredientPair.remove();
            });

            // Append inputs and button to the pair container
            ingredientPair.appendChild(ingredientInput);
            ingredientPair.appendChild(measurementInput);
            ingredientPair.appendChild(removeBtn);

            // Append the pair to the container
            ingredientsContainer.appendChild(ingredientPair);
        });

        // Remove button for initial pair (if any exists)
        ingredientsContainer.addEventListener("click", (e) => {
            if (e.target && e.target.classList.contains("remove-btn")) {
                e.target.closest(".ingredient-pair").remove();
            }
        });
    });
</script>
</html>
